### 2-1 Category分类业务分析

> 分类页面分析

- 方案1：一次加载所有数据
    - 如果只有2级分类，而且数据量不大
- 方案2：时时更新
    - 前端需要什么数据，就访问一次服务器查一次
    - 这样的问题在于，频繁点击一级分类就要查询一次二级分类的数据
    
> 选择方案取决于什么？

- 取决于你有 "几级分类"
    - 因为 级别过多，数据量是几何级别的增长
- 方案1：缺陷
    - 一级分类切换的时候，二级分类不会更新
    - 当用户切换到 分类 的时候加载一次数据
    - 更新分类数据的时机是什么？
        - 一个是 当用户 在底部tabbar 切换的时候
        - 另一个是 启动小程序的时候取一次，除非它退出了小程序，在进入点击 "分类"的时候取一次
- 注意原因是分类数据的更改，不会非常频繁
- 如果非要切换一级分类的时候去加载数据
    - 那么一定要做缓存
        - 缓存的更新时机，数据同步都是问题
        
### 2-2 Category接口数据结构分析与探讨

> 001 处理 CategoryController.java

```
@RequestMapping("category")
@RestController
@ResponseBody
public class CategoryController {

    @GetMapping("/all")
    public CategoriesAllVO getAll(){
        // List 如何处理？
        return null;
    }
}
```

> 002 实体类 Category.java

```
@Entity
@Getter
@Setter
@Where(clause = "delete_time is null and online = 1")
public class Category extends BaseEntity{
    @Id
    private Long id;
    private String name;
    private String description;
    private Boolean isRoot;
    private String img;
    private Long parentId;
    private Long index;
}
```

> 003 CategoryRepository.java 编写 JPA查询方法

```
public interface CategoryRepository extends JpaRepository<Locale.Category,Long> {}
```

> 004 CategoriesAllVO.java 因为 我们不可能把数据库所有字段展示给前端

```
public class CategoriesAllVO {}
```