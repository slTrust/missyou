### 2-1 访问Banner接口

> 录入数据

```
INSERT INTO `banner` VALUES ('1', 'b-1', '首页顶部主banner', '2020-03-25 03:31:31.967', '2020-03-25 03:31:45.818', null, null, null), ('2', 'b-2', '热销商品banner', '2020-03-25 03:32:17.741', '2020-03-25 03:32:27.303', null, null, 'http://i2.sleeve.7yue.pro/m4.png');

INSERT INTO `banner_item` VALUES ('5', 'http://i2.sleeve.7yue.pro/m6.png', '28', '1', '2020-03-25 03:34:12.521', '2020-03-25 03:35:22.602', null, '2', 'left'), ('6', 'http://i2.sleeve.7yue.pro/m7.png', '26', '1', '2020-03-25 03:35:15.661', '2020-03-25 03:35:15.661', null, '2', 'right-top'), ('7', 'http://i2.sleeve.7yue.pro/m8.png', '27', '1', '2020-03-25 03:35:45.819', '2020-03-25 03:35:45.819', null, '2', 'right-bottom'), ('12', 'http://i2.sleeve.7yue.pro/m1.png', 't-2', '3', '2020-03-25 03:33:09.677', '2020-03-25 03:33:09.677', null, '1', null), ('13', 'http://i1.sleeve.7yue.pro/assets/702f2ce9-5729-4aa4-aeb3-921513327747.png', '23', '1', '2020-03-25 03:33:33.323', '2020-03-25 03:33:33.323', null, '1', null), ('14', 'http://i1.sleeve.7yue.pro/assets/b8e510a1-8340-43c2-a4b0-0e56a40256f9.png', '24', '1', '2020-03-25 03:33:50.051', '2020-03-25 03:33:50.051', null, '1', null);
```

> 访问接口

```
http://localhost:8080/v1/banner/name/b-1

http://localhost:8080/v1/banner/name/b-2
```

### 2-2 @MappedSuperclass 的作用

**标识一个类是另一个类的父类**

> 访问 http://localhost:8080/v1/banner/name/b-1

- 发现返回的 json 里有 createTime/updateTime/deleteTime，但值为 null
- 因为 banner / bannerItem 继承了 BaseEntity 但是 它的字段没被映射

> 解决方案

- 添加`@MappedSuperclass` 注解

```
@Getter
@Setter
@MappedSuperclass
public abstract class BaseEntity {

    private Date createTime;
    private Date updateTime;
    private Date deleteTime;
}
```

### 2-3 Jaskson序列化库的重要配置（SNAKE_CASE、时间戳)

> 一个疑问 "Banner"设置为懒加载，但是 它的 items还是查出来了？

- 这是因为在序列化的时候，触发了这个懒加载
    - 由于有`@Getter`,在序列化的时候，回去调用 items的 get方法，就会去读取 items

```
@OneToMany(fetch = FetchType.LAZY)
@JoinColumn(name="bannerId")
private List<BannerItem> items;
```

> #### spring boot 里默认的序列化库

- jackson 

> #### 设置返回的字段格式 和 修改 GMT时间为时间戳

- `property-naming-strategy: SNAKE_CASE` 字段格式为 下划线连接
- `WRITE_DATES_AS_TIMESTAMPS` 设置 GMT时间转换为 时间戳
- [一些配置参数信息](https://my.oschina.net/u/2474629/blog/3126804)

```
createTime => create_time
updateTime => update_time
deleteTime => delete_time
```

修改 application.yml

```
spring:
  profiles:
    active: dev

  jpa:
    hibernate:
      ddl-auto: none
  jackson:
    property-naming-strategy: SNAKE_CASE
    serialization:
      WRITE_DATES_AS_TIMESTAMPS: true

missyou:
  api-package: com.lin.missyou.api
```

> 如何不序列化某些字段

- `@JsonIgnore`

```
@Getter
@Setter
@MappedSuperclass
public abstract class BaseEntity {

    @JsonIgnore
    private Date createTime;
    @JsonIgnore
    private Date updateTime;
    @JsonIgnore
    private Date deleteTime;
}
```

