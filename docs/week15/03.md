### 3-1 为什么需要提供多个SPU数据的接口？

> 首页瀑布流的 spu列表，和 spu详情 该如何设计表,和接口

- 写一个接口，返回 spu表里非常详尽的信息以列表形式
- 写两个接口，一个返回概要信息(列的内容少，以列表形式返回)，一个返回详情(列的内容多，但是返回的是一条)

> 不管那种方式都需要仔细考虑

- 比如瀑布流内容 概要信息多增了一个 信息
    - 一个接口因为始终返回全部信息，可以不修改
    - 两个接口则要修改其中一个
    
### 3-2 Spu实体映射（增补)

```
@Entity
@Getter
@Setter
public class SpuEntity extends BaseEntity{
    @Id
    private Long id;
    private String title;
    private String subtitle;
    private Long categoryId;
    private Long rootCategoryId;
    private byte online;
    private String price;
    private Long sketchSpecId;
    private Long defaultSkuId;
    private String img;
    private String discountPrice;
    private String description;
    private String tags;
    private byte isTest;

//    private Object spuThemeImg;
    private String forThemeImg;
}
```

### 3-3 Spu详情数据查询

- http://localhost:8080/v1/spu/id/2/detail

### 3-4 查询列表类数据

- http://localhost:8080/v1/spu/latest

> JPA写常规接口非常快

- 只要 SpuRepository 继承 JpaRepository

```
public interface SpuRepository extends JpaRepository<Spu, Long> {
    Spu findOneById(Long id);
}
```

- SpuService.java
    - JPA提供许多默认方法  一个findAll() 就实现了我们查找所有 Spu的方法

```
@Service
public class SpuService {
    @Autowired
    SpuRepository spuRepository;

    public Spu getSpu(Long id){
        return spuRepository.findOneById(id);
    }

    public List<Spu> getLatestPagingSpu(){
        return this.spuRepository.findAll();
    }

}
```

- SpuController.java

```
@RestController
@RequestMapping("/spu")
@Validated
public class SpuController {
    @Autowired
    private SpuService spuService;

    @GetMapping("/id/{id}/detail")
    public Spu getDetail(@PathVariable @Positive Long id){
        Spu spu = spuService.getSpu(id);
        if(spu == null){
            throw new NotFoundException(30003);
        }
        return spu;
    }

    @GetMapping("/latest")
    public List<Spu> getLatestSpuList(){
        return spuService.getLatestPagingSpu();
    }
}

```




