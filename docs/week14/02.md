### 2-1 mysql数据库连接配置

- Banner.java 添加注解

```
@Entity
public class Banner {
    private long id;
    private String name;
    private String description;
    private String img;
    private String title;
}
```

- pom.xml里添加 jpa依赖

```
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-jpa</artifactId>
</dependency>
```


- pom.xml里添加 jdbc依赖

```
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-jdbc</artifactId>
</dependency>
```


- pom.xml里添加 mysql连接器依赖

```
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <scope>runtime</scope>
</dependency>
```

- 配置连接数据库的信息 application-dev.yml

```
server:
  port: 8080

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/missyou?characterEncoding=utf-8&serverTimezone=GMT%2B8
    username: root
    password: 123456
```

### 2-2 Maven依赖无法安装的几个解决方案

- idea maven 工具栏里看 dependencies 是否都正常下载，飙红则重启 idea
- idea 首选项 maven 取消 work offline的选中
- 配置 maven 镜像

### 2-3 使用ORM的方式生成数据表

> 001 配置 jpa , application.yml

- ddl-auto有很多选项
    - update 常用，不会删除表清数据，生产环境一定要用这个
    - create 和 create-drop 慎用 每次运行程序都把表清空，数据也会清空，有了数据后不该清空
    - create-drop 更适合测试
    - none 最终会设置 node,禁止生成表
    
```
spring:
  profiles:
    active: dev

  jpa:
    hibernate:
      ddl-auto: update

missyou:
  api-package: com.lin.missyou.api
```

> 此时重启 spring 报错了，提示你如下内容

- 没有给 Entity一个标识

```
org.springframework.beans.factory.BeanCreationException: 
    Error creating bean with name 'entityManagerFactory' defined 
    in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: 
    Invocation of init method failed; nested exception is org.hibernate.AnnotationException: 
    No identifier specified for entity: com.lin.missyou.model.Banner
```

- 修改 Banner.java
    - 添加注解`@Id`

```
import javax.persistence.Entity;
import javax.persistence.Id;

@Entity
public class Banner {
    @Id
    private long id;
    private String name;
    private String description;
    private String img;
    private String title;
}
```

此时再去看 数据库就多了一个表 banner

### 2-4 常用实体类注解与ORM生成表的优劣势浅谈

> 字段限制，索引问题

- jpa生成的表 字段限制需要添加对应的条件，需要学习
- 而 mysql 可视化工具 直接就能对表的字段做设置，以及添加索引

> 表与表之间的关系

- 也需要学习 jpa 相关的知识


> 物理外键 逻辑外键

- 如果用 模型生成表也要处理物理外键问题， jpa 里可以消除物理外键，但是非常麻烦

> #### 模型一些配置 注解

```
import javax.persistence.*;

@Entity
@Table(name="banner1") // 此时生成的表名为 banner1
public class Banner {
    @Id
    private long id;

    @Column(length = 16)
    private String name;

    @Transient // 这样 数据库就不会生成 这个字段
    private String description;
    private String img;
    private String title;
}
```

- 实际 我们不会以这种方式生成数据库和表
- 对于orm操作数据库最重要的是：
    - **实体和实体的关系配置(比较麻烦)，可成倍提高开发效率**
    - 当然也可以单表查询，这样提高数据库查询效率，但会降低开发效率

